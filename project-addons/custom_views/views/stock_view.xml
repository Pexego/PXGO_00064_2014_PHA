<?xml version="1.0" encoding="utf-8"?>
<!--
© 2017 Pharmadus I.T.
License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl).
-->
<openerp>
    <data>
        <record id="custom_views_stock_receipt_picking_tree" model="ir.ui.view">
            <field name="name">Custom views - Stock receipt picking tree</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_tree_receipt_picking"/>
            <field name="priority">17</field>
            <field name="arch" type="xml">
                <field name="date" position="after">
                    <field name="purchase_expected_date"/>
                </field>
                <tree position="attributes">
                    <attribute name="colors">grey:state == 'cancel';red:purchase_expected_date &lt; current_date</attribute>
                </tree>
                <button string="Scrap Products" position="after">
                    <field name="purchase_amount"/>
                </button>
            </field>
        </record>

        <record id="view_picking_form_customview" model="ir.ui.view">
            <field name="name">stock.picking.form.customview</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="sale_commission.stock_picking_form_add_agent_field"/>
            <field name="arch" type="xml">
                <field name="agent_ids" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <separator string="Agents/Consultancy" position="attributes">
                    <attribute name="invisible">1</attribute>
                </separator>
                <field name="state" position="before">
                    <button name="duplicate"
                            type="object"
                            icon="gtk-copy"
                            string="Duplicar"
                            confirm="¿Desea duplicar este albarán?"
                            groups="custom_views.group_duplicate_button_picking"
                            class="oe_read_only"
                    />
                </field>
            </field>
        </record>

        <record id="custom_views_stock_picking_tree" model="ir.ui.view">
            <field name="name">Custom views - Stock picking tree</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.vpicktree"/>
            <field name="arch" type="xml">
                <field name="partner_id" position="after">
                    <field name="address_city"/>
                    <field name="address_zip"/>
                    <field name="address_country"/>
                </field>
                <field name="state" position="after">
                    <field name="date_done"/>
                </field>
                <field name="date" position="after">
                    <field name="responsible_uid" string="Responsible"/>
                </field>
            </field>
        </record>

        <record id="custom_views_move_picking_tree" model="ir.ui.view">
            <field name="name">Custom views - Move picking tree</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_picking_tree"/>
            <field name="arch" type="xml">
                <field name="product_uom_qty" position="after">
                    <field name="lots_string"/>
                    <field name="partner_id"/>
                    <field name="date"/>
                </field>
                <field name="location_dest_id" position="before">
                    <field name="location_id" groups="stock.group_locations"/>
                </field>
            </field>
        </record>

        <record id="custom_views_picking_form" model="ir.ui.view">
            <field name="name">Custom views - Picking form</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.view_picking_form"/>
            <field name="priority">20</field>
            <field name="arch" type="xml">
                <field name="name" position="after">
                    <field name="picking_type_desc" class="oe_inline" readonly="1"/>
                    <field name="edi_desadv" invisible="1"/>
                    <span class="oe_right"
                          style="margin-bottom: -30px; font-size: 40px;"
                          attrs="{'invisible': [('edi_desadv', '!=', True)]}">DESADV</span>
                    <span class="oe_right"
                          style="margin-bottom: -30px; font-size: 40px;"
                          attrs="{'invisible': ['|', ('edi_desadv', '!=', True), ('channel_name', '!=', 'EDI')]}"> - </span>
                    <span class="oe_right"
                          style="margin-bottom: -30px; font-size: 40px;"
                          attrs="{'invisible': [('channel_name', '!=', 'EDI')]}">EDI</span>
                </field>
                <button name="force_assign" position="attributes">
                    <attribute name="groups">base.group_system</attribute>
                </button>
                <button name="action_cancel" position="attributes">
                    <attribute name="name">confirm_action_cancel</attribute>
                </button>
                <field name="valued_picking" position="after">
                    <field name="photo_url" widget="url"/>
                </field>
                <page string="Additional Info" position="inside">
                    <div attrs="{'invisible': [('picking_type_code', '!=', 'incoming')]}">
                        <separator string="Return reason"/>
                        <group>
                            <group>
                                <field name="return_reason"/>
                                <field name="return_reason_details"/>
                            </group>
                            <group>
                                <separator/>
                            </group>
                        </group>
                    </div>
                </page>
            </field>
        </record>

        <record id="custom_views_move_search" model="ir.ui.view">
            <field name="name">Custom views - Move search</field>
            <field name="model">stock.move</field>
            <field name="inherit_id" ref="stock.view_move_search"/>
            <field name="priority">17</field>
            <field name="arch" type="xml">
                <filter name="by_product" position="after">
                    <filter string="Lot"
                            name="by_lot"
                            icon="terp-accessories-archiver"
                            domain="[]"
                            context="{'group_by': 'lots_string'}"/>
                </filter>
            </field>
        </record>

        <record id="custom_views_production_lot_tree" model="ir.ui.view">
            <field name="name">Custom views - Stock production lot tree</field>
            <field name="model">stock.production.lot</field>
            <field name="inherit_id" ref="stock.view_production_lot_tree"/>
            <field name="priority">17</field>
            <field name="arch" type="xml">
                <field name="create_date" position="replace">
                </field>
                <field name="name" position="replace">
                </field>
                <field name="ref" position="before">
                    <field name="create_date"/>
                </field>
                <field name="product_id" position="after">
                    <field name="name"/>
                </field>
                <tree position="attributes">
                    <attribute name="default_order">create_date desc</attribute>
                </tree>
            </field>
        </record>

        <record id="custom_views_search_product_lot" model="ir.ui.view">
            <field name="name">Custom views - Stock production lot filter</field>
            <field name="model">stock.production.lot</field>
            <field name="inherit_id" ref="stock.search_product_lot_filter"/>
            <field name="arch" type="xml">
                <field name="product_id" position="after">
                    <filter string="Can be Sold"
                            name="filter_to_sell"
                            icon="terp-accessories-archiver-minus"
                            domain="[('product_id.sale_ok','=',1)]"/>
                    <filter string="Can be Purchased"
                            name="filter_to_purchase"
                            icon="terp-accessories-archiver-minus"
                            domain="[('product_id.purchase_ok','=',1)]"/>
                </field>
            </field>
        </record>

        <record id="view_stock_quant_tree_custom_view" model="ir.ui.view">
            <field name="name">stock.quant.tree.customview</field>
            <field name="model">stock.quant</field>
            <field name="inherit_id" ref="stock.view_stock_quant_tree"/>
            <field name="arch" type="xml">
                <field name="lot_id" position="after">
                    <field name="lot_state"/>
                </field>
                <field name="in_date" position="after">
                    <field name="write_date"/>
                </field>
            </field>
        </record>

        <record id="stock.quantsact" model="ir.actions.act_window">
            <field name="context">{'search_default_internal_loc': 1, 'nodelete': True}</field>
        </record>

        <record id="custom_views_inventory_form" model="ir.ui.view">
            <field name="name">Custom views - Stock inventory form</field>
            <field name="model">stock.inventory</field>
            <field name="inherit_id" ref="stock.view_inventory_form"/>
            <field name="priority">17</field>
            <field name="arch" type="xml">
                <field name="filter" position="after">
                    <group colspan="4">
                        <field name="notes"/>
                    </group>
                </field>
                <xpath expr="//field[@name='line_ids']/tree/field[@name='product_id']" position="before">
                    <field name="product_description"/>
                    <field name="product_code"/>
                </xpath>
            </field>
        </record>

        <record id="custom_views_inventory_line_tree" model="ir.ui.view">
            <field name="name">Custom views - Stock inventory line tree</field>
            <field name="model">stock.inventory.line</field>
            <field name="inherit_id" ref="stock.stock_inventory_line_tree"/>
            <field name="priority">17</field>
            <field name="arch" type="xml">
                <field name="product_id" position="before">
                    <field name="product_description"/>
                    <field name="product_code"/>
                </field>
            </field>
        </record>

        <!-- Move option to inventory control submenu and add group permissions -->
        <menuitem action="stock.action_orderpoint_form"
                  id="stock.menu_stock_order_points"
                  parent="stock.menu_stock_inventory_control"
                  groups="stock.group_stock_manager"
                  sequence="10"/>

        <record id="custom_views_picking_search" model="ir.ui.view">
            <field name="name">Custom views - Picking search</field>
            <field name="model">stock.picking</field>
            <field name="inherit_id" ref="stock.view_picking_internal_search"/>
            <field name="arch" type="xml">
                <filter name="backorder" position="after">
                    <filter name="Send invoice by email"
                            domain="[('send_invoice_by_email', '=', True)]"/>
                    <separator/>
                    <filter name="EDI"
                            domain="[('sale_channel_id', '=', 'EDI')]"/>
                </filter>
            </field>
        </record>

        <record id="custom_views_stock_location_form" model="ir.ui.view">
            <field name="name">Custom views - Stock location form</field>
            <field name="model">stock.location</field>
            <field name="inherit_id" ref="stock.view_location_form"/>
            <field name="priority">17</field>
            <field name="arch" type="xml">
                <field name="scrap_location" position="after">
                    <field name="dismissed_location"/>
                </field>
            </field>
        </record>

        <record id="custom_views_materials_control_tree" model="ir.ui.view">
            <field name="name">Custom views - Materials control tree</field>
            <field name="model">stock.production.lot</field>
            <field name="arch" type="xml">
                <tree default_order="create_date desc">
                    <field name="product_id"/>
                    <field name="supplier_lot"/>
                    <field name="name"/>
                    <field name="input_qty"/>
                    <field name="input_uom"/>
                    <field name="container_number"/>
                    <field name="container_type"/>
                    <field name="create_date"/>
                    <field name="acceptance_date"/>
                    <field name="default_code"/>
                </tree>
            </field>
        </record>

        <record id="action_materials_control" model="ir.actions.act_window">
            <field name="name">Materials control</field>
            <field name="res_model">stock.production.lot</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="custom_views_materials_control_tree"/>
        </record>

        <menuitem name="Materials control"
            action="action_materials_control"
            id="menu_materials_control"
            parent="quality_management_menu.menu_qc_products"
            sequence="4"
        />
    </data>
</openerp>
